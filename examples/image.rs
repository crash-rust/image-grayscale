use base64::{decode, encode};
use image::{load_from_memory, ImageOutputFormat::Png};

fn main() {
    let source = r#"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"#;
    let source = decode(source).unwrap();

    let img = load_from_memory(&source).unwrap();

    let img = img.grayscale();

    let mut buffer = vec![];
    img.write_to(&mut buffer, Png).unwrap();

    let img = encode(buffer);
    let data_url = format!("data:image/png;base64,{}", img);
    
    // assert_eq!(result, data_url);
    println!("{:?}", data_url)
}
